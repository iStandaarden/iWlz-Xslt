<?xml version="1.0" encoding="UTF-8" standalone="no"?><stylesheet xmlns="http://www.w3.org/1999/XSL/Transform" version="1.0"><output encoding="UTF-8" indent="yes" method="xml" version="1.0"/><template name="t0"><param name="p0"/><if test="$p0 &gt; 0"><call-template name="t0"><with-param name="p0" select="floor(number($p0) div 10)"/></call-template><value-of select="number($p0) mod 10"/></if></template><template name="t2"><param name="p0"/><choose><when test="number($p0) &lt; 0">-<call-template name="t0"><with-param name="p0" select="0 - number($p0)"/></call-template></when><when test="number($p0)=0">0</when><otherwise><call-template name="t0"><with-param name="p0" select="number($p0)"/></call-template></otherwise></choose></template><template match="*" mode="m0" priority="100"><param name="pMessage"/><choose><when test="$pMessage='aw310'">aw39</when><when test="$pMessage='zk310'">zk39</when><otherwise><variable name="v0"><value-of select="translate($pMessage,'0123456789','')"/></variable><variable name="v1"><value-of select="translate($pMessage,$v0,'')"/></variable><value-of select="$v0"/><value-of select="1*$v1 - 1"/></otherwise></choose></template><template name="t1"><param name="p0"/><variable name="v0"><value-of select="substring-before(substring-after(substring-after(substring-after($p0,'http://www.istandaarden.nl/'),'/'),'/'),'/')"/></variable><variable name="v1"><value-of select="substring-before($p0,$v0)"/></variable><variable name="v2"><value-of select="substring-after($p0,$v0)"/></variable><choose><when test="$v0='basisschema'"><value-of select="$p0"/></when><otherwise><value-of select="$v1"/><apply-templates mode="m0" select="."><with-param name="pMessage" select="$v0"/></apply-templates><value-of select="$v2"/></otherwise></choose></template><template match="*" mode="m1" priority="0"/><template match="*[local-name() = 'IdentificatieRetour']" priority="10"/><template match="*[local-name() = 'DagtekeningRetour']" priority="10"/><template match="*[local-name() = 'XsdVersieRetour']" priority="10"/><template match="*[local-name() = 'RetourCodes']" priority="10"/><template match="*[local-name() = 'RetourHeader']" priority="10"/><template match="*[local-name() = 'RetourBedragen']" priority="10"/><template match="*[local-name() = 'ToegekendeBedragPrestatie']" priority="10"/><template match="*[local-name() = 'BerichtCode']" priority="10"><variable name="v0"><call-template name="t1"><with-param name="p0" select="namespace-uri()"/></call-template></variable><element name="{local-name()}" namespace="{normalize-space($v0)}"><value-of select="1*text() - 1"/></element></template><template match="*[local-name() = 'XsdVersie']" priority="10"><variable name="v0"><value-of select="substring-before(substring-after(substring-after(substring-after(namespace-uri(),'http://www.istandaarden.nl/'),'/'),'/'),'/')"/></variable><variable name="v1"><value-of select="translate($v0,translate($v0,'0123456789',''),'')"/></variable><if test="$v1!='304'"><call-template name="t3"/></if></template><template match="*[local-name() = 'Header']" mode="m1" priority="10"><variable name="v0"><value-of select="substring-before(substring-after(substring-after(substring-after(namespace-uri(),'http://www.istandaarden.nl/'),'/'),'/'),'/')"/></variable><variable name="v1"><value-of select="translate($v0,translate($v0,'0123456789',''),'')"/></variable><if test="$v1='304'"><variable name="v2"><call-template name="t1"><with-param name="p0" select="namespace-uri()"/></call-template></variable><variable name="v3"><value-of select="namespace-uri(*[local-name()='RetourBedragen']/*[local-name()='IngediendTotaalBedrag'])"/></variable><variable name="v4" select="sum(ancestor-or-self::*[local-name()='Bericht']//*[local-name()='Client']//*[local-name()='IngediendeBedragPrestatie']/*[local-name()='DeclaratieFactuurBedrag' and ./*[local-name()='DebetCredit']/text()='D']/*[local-name()='Bedrag'])"/><variable name="v5" select="sum(ancestor-or-self::*[local-name()='Bericht']//*[local-name()='Client']//*[local-name()='IngediendeBedragPrestatie']/*[local-name()='DeclaratieFactuurBedrag' and ./*[local-name()='DebetCredit']/text()='C']/*[local-name()='Bedrag'])"/><variable name="v6" select="$v4 - $v5"/><element name="DeclaratieFactuurBedragen" namespace="{normalize-space($v2)}"><choose><when test="$v6 &lt; 0"><element name="DeclaratieFactuurTotaalBedrag" namespace="{normalize-space($v3)}"><element name="TotaalBedrag" namespace="{normalize-space($v3)}"><call-template name="t2"><with-param name="p0" select="0 - number($v6)"/></call-template></element><element name="DebetCredit" namespace="{normalize-space($v3)}">D</element></element></when><otherwise><element name="DeclaratieFactuurTotaalBedrag" namespace="{normalize-space($v3)}"><element name="TotaalBedrag" namespace="{normalize-space($v3)}"><call-template name="t2"><with-param name="p0" select="$v6"/></call-template></element><element name="DebetCredit" namespace="{normalize-space($v3)}">C</element></element></otherwise></choose></element><for-each select="*[local-name()='XsdVersie']"><call-template name="t3"/></for-each></if></template><template name="t3"><variable name="v0"><call-template name="t1"><with-param name="p0" select="namespace-uri()"/></call-template></variable><element name="{local-name()}" namespace="{normalize-space($v0)}"><copy-of select="@*"/><apply-templates select="*"/><apply-templates mode="m1" select="."/><value-of select="text()"/></element></template><template match="*"><call-template name="t3"/></template></stylesheet>